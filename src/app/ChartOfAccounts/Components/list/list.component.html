<div class="table-container" *ngIf="!loading; else loadingTpl">
  <div class="table-header">
  <h2>{{ 'CHART_OF_ACCOUNTS' | translate | async }}</h2>
  <span class="employee-count">{{ accounts.length }} {{ 'ACCOUNTS' | translate | async }}</span>
     <button class="create-button" (click)="openCreateModal()">
        <i class="material-icons">add</i>
        {{ 'NEW_ACCOUNT' | translate | async }}
      </button>
  </div>

  <div class="table-wrapper">
    <table class="styled-table">
      <thead>
        <tr>
          <th (click)="sortData('id')" class="sortable">
            {{ 'TABLE_HEADER_ID' | translate | async }}
            <span class="sort-icon" *ngIf="sortKey === 'id'">
              {{ sortDirection === 'asc' ? '▲' : '▼' }}
            </span>
          </th>
          <th (click)="sortData('accountCode')" class="sortable">
            {{ 'ACCOUNT_CODE' | translate | async }}
            <span class="sort-icon" *ngIf="sortKey === 'accountCode'">
              {{ sortDirection === 'asc' ? '▲' : '▼' }}
            </span>
          </th>
          <th (click)="sortData('accountName')" class="sortable">
            {{ 'ACCOUNT_NAME' | translate | async }}
            <span class="sort-icon" *ngIf="sortKey === 'accountName'">
              {{ sortDirection === 'asc' ? '▲' : '▼' }}
            </span>
          </th>
          <th (click)="sortData('accountType')" class="sortable">
            {{ 'ACCOUNT_TYPE' | translate | async }}
            <span class="sort-icon" *ngIf="sortKey === 'accountType'">
              {{ sortDirection === 'asc' ? '▲' : '▼' }}
            </span>
          </th>
          <th>{{ 'PARENT_ACCOUNT' | translate | async }}</th>
          <th>{{ 'IS_DETAIL' | translate | async }}</th>
          <th>{{ 'ACTIONS' | translate | async }}</th>
          
        </tr>
      </thead>

      <tbody>
        <tr *ngFor="let acc of accounts; let i = index" [style]="'--row-index: ' + i">
          <td class="id-cell">{{ acc.id }}</td>
          <td>{{ acc.accountCode }}</td>
          <td class="employee-name-cell">
            <div class="avatar">{{ acc.accountName.charAt(0) }}</div>
            {{ acc.accountName }}
          </td>
          <td>
            <span
              class="status-badge"
              [ngClass]="{
                'status-active': acc.accountType === 'Asset',
                'status-on-leave': acc.accountType === 'Expense',
                'status-terminated': acc.accountType === 'Liability'
              }"
            >
              {{ (acc.accountType | uppercase) | translate | async }}
            </span>
          </td>
          <td>{{ acc.parentAccountId || ('NO_PARENT' | translate | async) }}</td>
          <td>
            <span
              class="status-badge"
              [ngClass]="{
                'status-active': acc.isDetail,
                'status-on-leave': !acc.isDetail
              }"
            >
              {{ acc.isDetail ? ('YES' | translate | async) : ('NO' | translate | async) }}
            </span>
          </td>
          <td class="actions-cell">
             <button class="action-button edit-button" (click)="openEditModal(acc)">
              <i class="material-icons">edit</i>
              
            </button>
               <button mat-icon-button color="warn" (click)="openDeleteModal(acc)">
              <mat-icon>delete</mat-icon>
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="table-footer">
  <p>{{ 'SHOWING' | translate | async }} {{ accounts.length }} {{ 'RECORDS_FROM' | translate | async }} {{ projectName | titlecase }} {{ 'PROJECT_SCHEMA' | translate | async }}</p>
  </div>
</div>

<ng-template #loadingTpl>
  <div class="table-container text-center">
    <mat-spinner diameter="48"></mat-spinner>
  <p>{{ 'LOADING_CHART_OF_ACCOUNTS' | translate | async }}</p>
  </div>
</ng-template>
